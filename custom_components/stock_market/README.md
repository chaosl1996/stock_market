# 股票市场信息集成

这是一个Home Assistant自定义集成，用于获取和显示中国股票市场的实时行情数据。

## 功能特性

- 支持添加多个股票代码
- 显示股票的实时价格、涨跌幅、涨跌额等关键信息
- 支持自定义刷新间隔
- 遵循Home Assistant的标准单位属性规范

## 安装方法

### 通过HACS（推荐）

1. 打开HACS
2. 点击"集成"
3. 点击右上角的三个点，选择"自定义存储库"
4. 添加此存储库的URL
5. 搜索"股票市场信息"并安装

### 手动安装

1. 下载此集成的ZIP文件
2. 解压并将`stock_market`文件夹复制到Home Assistant的`config/custom_components/`目录下
3. 重启Home Assistant

## 配置方法

1. 在Home Assistant中，前往"配置" > "集成" > "添加集成"
2. 搜索并选择"股票市场信息"
3. 在配置表单中填写以下信息：
   - 完整代码：格式为"市场代码.股票代码"（如：1.000010）
   - 股票名称：自定义的股票名称
4. 点击"提交"完成配置

**代码格式说明**：
- 格式为'市场代码.股票代码'，例如: 1.000010
- 市场代码参考: 1=上证, 0=深证, 105=美股, 116=港股, 122=日股, 124=英股, 125=德股
- 完整代码可在东方财富网查询

## 实体属性

每个股票实体提供以下属性：

- **状态**：当前价格（元）
- **额外属性**：
  - stock_name: 股票名称
  - stock_code: 股票代码
  - change_percent: 涨跌幅（%）
  - change_amount: 涨跌额（元）
  - prev_close: 昨收价（元）
  - volume: 成交量（手）
  - turnover: 成交额（亿）
  - amplitude: 振幅（%）
  - turnover_rate: 换手率（%）
  - timestamp: 数据更新时间
  - unit_of_*: 各数值的单位

## 自定义选项

在集成配置完成后，您可以通过以下步骤调整刷新间隔：

1. 前往"配置" > "集成"
2. 找到已配置的"股票市场信息"集成
3. 点击"选项"
4. 调整"数据刷新间隔（秒）"（最小值60秒，最大值3600秒）
5. 点击"提交"保存更改

## 注意事项

- 本集成使用东方财富网的API获取数据，仅供个人学习和研究使用
- 数据刷新频率过高可能导致API访问限制
- 建议设置合理的刷新间隔（默认300秒，即5分钟）

## 故障排除

### 常见问题

1. **实体状态显示为"未知"**
   - 检查股票代码和市场类型是否正确
   - 等待几分钟，让集成有时间获取数据
   - 检查Home Assistant日志中的错误信息

2. **无法添加集成**
   - 确保您的Home Assistant版本符合要求（2023.8.0或更高）
   - 检查custom_components目录中的文件是否完整

## 更新日志

### 0.1.1
- 修复：解决设备名称配置问题，确保设备名称与实体名称（股票名称）保持一致
- 优化：移除不再使用的常量导入

### 0.1.0
- 初始版本发布
- 支持添加多个股票代码
- 显示实时价格、涨跌幅、成交量等关键数据
- 支持自定义刷新间隔

## 感谢

本集成基于东方财富网的公开API，感谢东方财富网提供的服务。